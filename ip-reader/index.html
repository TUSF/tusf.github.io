<html>
<head>
  <title>IP-Reader</title>

  <!-- Load IPFS. -->
  <script src="https://unpkg.com/ipfs/dist/index.min.js"></script>

  <script type="text/javascript">
    const node = new Ipfs({ repo: 'ipfs-' + Math.random() })
    node.once('ready', () => {
      if( window.location.hash.length > 1 ) {
        hash = window.location.hash.substr(1)

        // Load the index within the hash.
        // The structure of a manga series should go something like this:

        // manga/
        //   Ch1/
        //     001.jpg
        //     ...
        //   Ch2/
        //   index.json
        //   toc.json
        //   cover.jpg

        // index.json should contain a single object with metadata about the given series.
        // toc.json should contain a list of all chapters (in order), with metadata on each chapter.
        node.files.cat(hash + "/index.json", function(err,date) {
          if(err) {
            return console.error('Error - ipfs files cat', err, res)
          }
          console.log(data.toString())

          node.swarm.peers().then(a => console.log(a))
          console.log('Online status: offline')
          document.body.classList += "online"
        })
      } else {
        console.log('Online status: offline')
        document.getElementById("status").innerHTML= 'Node status: offline'
      }
    })
  </script>
  <style>
    body.online #status { display: none; }
    body #reader { display: none; }
    body.online #reader { display: shown; }
  </style>
</head>
<body>
  <h1 id="status">Node status: loadingâ€¦</h1>
  <div id="reader">
    <h1>Online</h1>
  </div>
</body>
</html>
